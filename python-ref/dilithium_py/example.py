from .dilithium import Dilithium2
from .keccak_prng.keccak_prng_wrapper import Keccak256PRNG

# msg = b"We are ZKNox."
################################################
# pk1, sk1 = ETHDilithium2.keygen()
# sig1 = ETHDilithium2.sign(sk1, msg)
# assert ETHDilithium2.verify(pk1, msg, sig1)
# ################################################
# pk2, sk2 = Dilithium2.keygen()
# sig2 = Dilithium2.sign(sk2, msg)
# assert Dilithium2.verify(pk2, msg, sig2)
################################################

# pk3, sk3 = Dilithium2.keygen(_xof=Keccak256PRNG)
# pk3 = bytes.fromhex("002d96a835a3abee9c6985ce30ac9921df098e7a3e26c09fd8d8533d35c3b3488356464f4a42a9d82f592b5f214aa68a2d47a5c149bd4d692cbee4a05e8dbbc45f34883303f2cbf0977cba52e658908f7e632094989faa8aba75d0059b2238338a3f74becbc294e700cd92949491f65736257b84ed7029fd62973ac54c0e9922f7c02356f24155379dd233bc84d8174566f8ef5cfa9444d3fc83d12522b965846d255b5a4e3c1c2adccfd0fc658bbb348b3cea58f427e9c9010af7e88bcea48ed2c09b2c5e5368d3c5775883276b188c03d3f8509ca1c66082aab8c807921de5638d6d5d620a620d7f1e27cbd43ca8f2926733dc93b708649e26adb7d11a80b9d86062302b42c56a415f8130b2d4086097032c688a3595024184957c691ca51dc73df0cc98839df4ef8484f87d284a8253a393130447ad7fa41348ae548f98dd47afc9806c94845644ac819bdebb1bda1818d07a96cdf63e9e7f06c5b35b52013e34131cbdf9c8ed2fc687bae75db6157d62aba33d93bc7bd695de75ec9631148076ba47bf87e09ad8eb2114e1d26d4e5b50e8dc5d71bb2f6353922253a5a058b2610879ceac94e33d5ac8acf7dec337a60ab0e1c776a19b93cb507ba9a9c2fbd3c45239642bfd21c100a2adfa7f595432be0740b2d3e8792229540c7c0d6ae7fce708d2ac7851056b7a70b5ed5a046ecf98e236c771020ec016c7588ef689e1dd5da0887c4da6ddc696a2edafec5d4be08d7a62dd418d6e3a5aee89b709f9851441223fbd4d21287522411a9be471f753ab1307ae065f51b589e435671593adc77e74e97620041665b6385419aaabb7c26c9e82c6c36fafb5c6fc62d874afb1540ebfd25906588151eb9214bf3527fca6085643a51e045f184806093f5680ceca5a22b5c3401a74619f6c59f0e86c51656aceba13daad3b389f2fd2b2ce8a612c28b45b2552f629f2f19183de04cbe5b6fd93a8181aff4bfae2da0333b6800c92a8466764a446e8a7cb1ca1279f34889a91528b30f3f2e5bce9a5426e51890aea4a586df2a3dc899206b4b6ff388c88e42e2848b8dcc229138486f1dca2ab57a3dfb43322593aae150e6b1deb73c2e371741ce95b83c07d440a952633dac527c1ee2b14bf5b7e80fe66f1744faf3279b98f91ef6609bd7df66980b04638af897bfea27c47b1b8a93296ee65f5cb1f6269afaa7c587b527d0b90004792421a41dbe886d3d733f828cc7070905ecb82d8caf9855b292f51d4f7ef51fb1463254a5c84f53968de26a83711902923cf648be48d020087b8c25dbe6999aada6eb33a6d19a8a8cb52808888f562dd4e3be006cc3f367d7957522a6697e61802da0fc3f8ed09d0fbc1b59b6140db94929e7809660e2d29efa3fe8d5d09e78cc235b0b60881e330ec4b94f86063ec5cdf18a7988e87488bdadfa738b21791e990c30e6fe376d894847d104d78dc92323c586cb110b53b96c70d612b2945a21a0e1b4a44d9d3c021ed047faf244504fed6d1111ab970aa498fba2930d13733349968ef213d0c36bae2f5865df8e45b40be51470be6dabd21d29c1e82969bc8dc0cf95c875de6d833ceb8d9fca880924e80944c379090b0cdb57a691b49254f76247e76864f43257b312cd2c23f3a0a89a61d7b808f4909eba5f071dae06014cc024acdad73c6e21b0e19358024c833550ce2422ee2793469ee61c45d4730ce4535aa8a3ce6b1b1b9ade62d5c11ba7a5290b432cf0b4cb1b9759c3ea4c027735cc080f890f2f697c81a890417ca14f575f9de6f8e813ba1b7e90a97eb52f3f2504c38c72b4b788d26b7a1a8468401ad2a31641457077c61ff1318ac9053911cfafd8cd8ad")
# sk3 = bytes.fromhex("002d96a835a3abee9c6985ce30ac9921df098e7a3e26c09fd8d8533d35c3b3484691940313afdd1038496a414f035ec7c891e100627e77b1972a4b52596dd74d6b1cc276408aea941a28b4ffc859077fff7a46784657fd8d4ca8d7e77388fc0403b80c59406958140c4b042c12348e0a9631e41424e0344a193391090171513840d2a28849466cc2a05142208c1ca365d18884a3980909018ac3162401214d5880085c96408b380a83968dc9481221352e6188019ac684c89829d402884c04654242484b262683082d414250d2204011252d4ba28c4324105300408b386d139584d4808c4106909ba2604cc430db8650cac88949b66c90224dc82070cb3852d2124980b8710b973182408e9c328192488503147109426610294cc9a6691b8421a248709826660234611b032421456a12044822a300922449d32088033521ca001293b62064c83010b92c00944514a7019ca684d042290cb48900084d22416852064499a470129464241146a4962491086624188e20158d00c44063965018876d10352ea23008d0b091118821a38201db306c240769c344298808448b20901014041aa5910932884b9621099620c320809c44904c086ee3a80cd3124548009081328218818d0c480e402444109861d0c448601810034690e2322d5c9211c8926ca4427281c4290a11705a143218b57110254424082e41000d104444e0262e61b88863844d48b471c1c8804c122291b0484046064a264014a64c10244d03c22c0b23111387641984250bc42110a3685a18300b193024985102b804cc8245834610c8105280c224c14450c9124c4a4284490072a1b28480948822a841e0c68c01108ac9b2251a4590d088080b181084b631d0420d88324660068141a021829645d24488098431110671190871a2b8498c944118060c18466013182998124c44a64112138a0c450259844d84028a4ac08551104cd1166cc1040aa4300490b20814222549105241248cc2202202a68d40880514813123012dcab485102830183770c8204142021258144409962904454d08b5919310044a4620c3268e503621232789c0c23004b7642025620c271021290253c20d1bc86d003912d830094212210148641c118483b64c18c40048c640029581cc3451c92632812650098030d1222488246002366400b5205318891c24250b2726839649981832128748413470c03885bae6912191b8d042671026b9bc0a2e0d131eb22de8fb3bda887252ded74f706b9acd55e5dd06d3b27a1a045a6c543834229b25eb3fa6f044254c4283ec12e88b17aafa8fe42eb3dd2f2c8d168578d4ec5dd4f0077d2ec6216b3afc39e3ccb20b7419bde65fc88402c6d35bdddaa020a83cb45a7f27d6658d5be44f60802122b50149180e71eaa2654d12672468f9c638b75617b64d11b6fef424833e7337d7dada191ba0936ac62219a4f363c53655c059447542e39097bbf30b63c04f5c2fc53dbd66b9d4d633a933d8e9a29c218fd1e9b844f452202d9bb9cbc1bee01107575d12b18ea883caee278c28800d61a1436cee55389452bb04c6c05bb72779c2674a00b858a6b61ca776f4e444a63d8838490e5326b127ae99ab02ed1c513f206a3444291d38edefdb8f34c7391643068a2570a6088953c56d0da3b5b363b2f2d247cdfee7a3c0e8ccc85adce5fc93f2143fbfe1cbae07aa244a8226de89e8a87809347811c8a85409108f7e6c4c786b596566b19c6342d1c6c4c96cff5bd143e567fe720c1acdf07a33e4264b166988c5c67509b4d2cfb7a776f02a16dffa3f1ccd94f8399cb552a88e66348cbb4d35fa16783b402d0a779aa4c67b90ae93b54be415f760ee5bb3265d23842b70773fd554208ccba8a808be1084a0af920a835110eb4030e034a4cb45acf49f3537f3f07917562970d24bfe1791c6a02bf171ec74f9716d1d08bd4ba2a89896a7b85434d507c6e190eaf2a8a23069ba5d246b2aa1688e442d00672160cc959819ab85008eee0795fd2254425bdfbd1e5790da495e3b21597463024bb953fb4a27ccb2434561639e1f83ce870b7541cbd101a918d02084c14ce42262b67f784c69ad4d0797907e6c53536834a975130abab38ead52d2d27bab7528e665caa0280626190293e08474d8d24cc141ec6c107423a0dd64e5ac9b4f65312dd1fff6556d81065fee5d977199a8ca733487c2b69642980fd5bb78f59d7f7b863fa46405e4645bd877bc2e1b7e4d196349fc01e7859d5a4a03b965ef6dd91ee26f83d64945c544af6d457c6ba3db1613e014e531bea822997c4fc27c90cebfd277e3040a28e02f12fa277bbb51bff78573a238027e8aed9ea457b25d3c316ca816e6a31532a7381fca4739bfb3659d522b26f7f0b4864ebe4192f7555a848a9b04edde9dbb3d3fff8d2f49dbaa93ecaeff6162de82e035d8f0862501596d90b07ade7e9407d049c21cc2a7d558d677532257665a0d933746cab85f49982e693582b9d435a7413cc3f0ef0710ed9aae3d8095d72462d9c0e7618868369bbf43dc9ba1fe6cd5ef47aa308202a8d61ae2c311ec369ec46aa96e19fcb9036467e54477218cb76522f9c184a3894b365d20df664c84756793276cccd7dd5a53ec5e8aa5b05619061cdb04853e26672465955cd90bc433bd9ce7746b057b8c570f2288dcf37633c26554a621e1fac99a59368490e164b4531b409daa0822c9f314d20b67faf383cba725153d1584c8150bbfc6c229eef9a0e4c6b77a6be97fea9c07288c984662d49202c0fc9a92d1ba6c4a657fcb9cb17b6120eae55955b689f85baf28ffded953f233bd6938e4c8098e8ba99d7e80298fb6e7c753204de05e2bd0431df98777d97b6eab7f8c03fae79cf452d31dc6b702136ea977881f0e6377d615aee6beb5637373d2d69a4a2faa1e0c3ba1e22db0c5fff8c3fb1dfcd65beba8a894e749863b0c428ca90045066c0069c53880d47098e9ed808ee38f626b69bc11443daaf96f2b4de09d2f46d395687e224500e37085451f29bd47279cf03c6bdab9c67dee0e5bc727b31e75570412f9df183eaf9a42cd732ba3ffe41299ac35f5236443cedd412087728cb1368853c19f2ce8c6ba539981276e5de093db795a0299c6d972a335a7039ff8dd7e1339a97b14aadd544e1070469b188a50fc389a91bc3b3bc44b09af2d5392b31499e23609e194ec205f4e2ad60d6bf8dd22fc70508ee6c44138c7fb178a83f3dc5e3acc8a3484f16ad2a511157c4ed7f4885283ce814a634ad0c0e222a75ac227e7251682731dc3c0e9a3587083020180b19ecbdee23baeb86599426dec1d8aa7143cb8289a69c752ed6ef101140f5707326b05bf75f9c9d9c439383baefa2ca62777fab818cec28eb0ca6e960bd277039478fa772bfd8350473ea1a8b0bf877784a1c4dd5561ffd5f1becc439b3201137b432f5a3d9c49308c221cdf65f839bb228b03340df536708f73bb9805230ab89aaf4286a8318a753f4da0e042240b8bc337aaa39a1767c5b175c06d5ee3e4922a16c80095fb56a14d4c7c246d578de3d9abaa5be19f8036043e2ec0")

# sig3 = Dilithium2.sign(sk3, msg, _xof=Keccak256PRNG)
# assert Dilithium2.verify(pk3, msg, sig3, _xof=Keccak256PRNG)

# this is the first test vector from the KAT files of ML-DSA.
seed = bytes.fromhex(
    "061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1")
pk = bytes.fromhex("DC7BC9A2E0B6DC66823AE4FBDE971C0CFC46F9D96BBFBEEBB3470AE0A5A0139FDD6A6CE5BC76E94FAA9E9250ABD4CEE02CF1EE46A8E99CE12D7395781FA7519021273DA3365519724EFBE279ADD6C35F92C9D42B032832F1BF29EBBECD3EC87A3AF3DA33C611F7F35FA35ACAB174024F118979E23BF2FE069269A2EC45FBC1B9C1FB0E1F05486A6A833EB48ADC2960641D9AF6EB8B7381B1EC55D889F26B084DDFA1C9ED9B962D342694CEDE83825309D9DB6BD6BA7582132534861E44A04388A694242411761D34E7C085D282B723C65948A2AC764D9702BD8ED7FE9931D7D8704A39E6508844F3F84843C305594FE6E5404E08F18ED039AC6563CBAA34B0CA38320299D6256EC0F78D421F088159D49DC439CBC539A55884A3EB4EFC9CF190B42F713441CB97004245D41437A39B7B77FC602FBBFD619A42363714B265173CAE68FD8A1B3CA2BD30AE60C53E5604577A4A3B1F1506E697C37432DBD883553AAC8D382A3D250CF5B29E4D1BE2CBCD531FF0E07E89C1F7DBC8D4529AEEBE55B5CE4D0214BFDEC69E080BD3EF36CCA6A54933F1EF2F37867C0D38FD5865B87929115808C7E2595458E993BACC6C5A3B9F5025001E9B41447708BFBAA0462EFA63876C42F769908B432F5485508A393224960551D77EADFAF4411CBC49FDFF46F2F155DDD6EC30867905B709888CA0F30F935FB8D7F4803CFC7A5F7790CA181D99CA21F2621D69A5C6D49C76B4969DA62740A378470332B30947AB31CCDB9BA0C7B625879EEC4BD81F0200BA23504A7DC3B118BC2AB1145DF13AF3C8CC39F577873B84911B3D85FBBF4CB19E4D36B10A938EEB78B599DC86615FD6CEC6EB7B8F7AFA5F6D6BE19EA81630D36CCFB2F487DE50D0CF46DA8D3FE3512812043C0E3EF2D7231FB0B0A35A0FB283BE30A1247780F30AE0294E8B6F5897383EDB895595F577524DF54593CDF927B4967616EE3913E4D6B29B0DBD7C33A2A45E4EF1B1954EA5D91CE37EFC1302E7CE02A97395565DA2A5C5D3FDB0D87684E9B1C0AD07EC33DF2DFAD528E2EA0966D2A47DD5EE88E77D653C0D004FAB0165F0757C4DA40AF327E7192536C79947A80A827AA2107DACFAE3DEBFC8FAD3D6E08076D938C510A276BDF6721A1F087CB169515028AD5CE27A1047ABD92809934CA63B893F71F9A34A99C0FD30310C47E9AA37394D0AB73B254D3CA69D9C5549C9479AAE24264AC5EA64D3FD821C3962EC77E709F9D30BC7B65A52E48C16E80603558CACA1811411C3155D1F949FC9CF9AA9385A7199E99BE77A66FAD7EED91258DE55B2C4C83F9A050ADEBEA5F09758F40DAC4A1C394EE8D687879150D26426895AB1938E14AE11B376254C91FC6130436996F8ED43BD27BE20EC9067111C116EC94CC2B06CC91A13C5D10BBD7EECEA4792F17B2B77631EF145E9FB41A83EAA11C2B72A48FB90FDBD88644C4EDF8AB20DCE3118364B276AC1237B36C8926E346AAB5A111AA0BF341C518B7BFF9E9DBB8BCB4728601B3760663E67650331E6FB54AC82FC414CB8DDFC160A25311EC5272DE46217FEF8B992FF89754FBEE351F21BB90B6C97078B510C983350681266C8FED1F0583C5151E7B8FE3B7292319699687CC6B641FDBD689428543BC0FA1FACC109DE65B62784C2D985AB15D77D3AF12AF6D03E8D1859A553688584D75EF673A1DE74093EE108C761FFF32C217C231B0E2953DAF521429264C0963BC8A5CDEDDC617A7285B934EA51DDB5CDAB23BCEDE86BE36E001BC65C65E9A1C94BAFF4FAB8EB5F8ED42EC377423633FE00049142467C47C5D58A7202C8E9104841C1F7F380145A6A0A828C570235E507AE5868A6062F722BB98FF6BE")
sk = bytes.fromhex("DC7BC9A2E0B6DC66823AE4FBDE971C0CFC46F9D96BBFBEEBB3470AE0A5A0139FF037B84E75537E0A1CF02A517ACFE323FFFFE11DF72E4F38430E0E66A2654B2F2EF757DA47649D9F63FA03F1BF6FE6BC7C62971A98A2BD9D36EB0EC43AD4E9D940DF3BB5874F5C92192AA31E0535D3CF70950BBA858D11A688EAF854F63ECFC520C50D624891434265D8B0680C03061040299A104082C0910C8508D1100D44A6509408292211125B90508A2688E1302DC4021280028AC302611820851237808A000AE2040421B4910BB80550A08051B2511C28428A3672A494504910201BB45161424424A75001328181942D62A850023449CA94200B296213156408924C48122100B605030208E0060200A311E1802021116483A62898029291480801083041066613200E5B360951400C53000AA08851944842E316704AB2089B92440025121B0309418209C2A0800B290A819851C4340DA4424500A0105B048E603400138928A4422648002C90202D194068E2146D19278A083746E4146914006422C660D3A03013242844965014166DA0284DCC462E94367100232E1C114909A2040131060A2172C2142ADA000C5A260D13228A62C444E3142D013445980224D33841C0308121A621E348720B1984D2C89108B8690887714A2884D496451A9301CA2285DA30859AC851DCC00820106060465262302AA224251044640B2842988011540692144251D236719BB4900B082890188E41C469E1A469032160E01409D3020C20C88C1CB23164086218476920228CCB8470089528029550533270013405888424541041D202881AA84CCAC88181008D0392899AB809D9900C9A1290614065C9322D89860C123521CC4266C8360010062411028EA3B44D44023043A0285A002ED1980C4882658922441C010212907084226E12134D011902519064113364C91806C2C04589262908B63024308CDA022E0C27250B367058162C5116420B4946C1208841246C99466A04434E18A86C821661922028639409C30211029520211782D43868003460C84688E0160000A32DC0A82824B640831464C81022A2086503234AC8122EA098418C2072CC308A62C665093408412682DA429089328514967081226001176D5948428AB88D592051D80892E2C0889044700AC0245A020904218A59C45094441094140820460209270C441020DCC8209212015038250C456E4A1666223770DC808CA426412222441BA3618A343099844099C42952046D88146CCB242A7CD129A8D333115C62D033B6A8357CF7CD10268AB12F16FCEB7975D0A28A6C4822213C9A772DF084AD91A669E2040550FC5E8D0AEB10FAB2375FC9625EF9CD48C19631997A1CB6455D2C6286C569C9637ADD0317CE990996B28E51C3F3F717FB5907BBDD53961AD3497F2C3C473CCE170906AC4C624A89AA8FBE624D99385E9C9548BF05E8CAFD47D2476E41B73001F813726499E88B2B3B6F596CA311657850346598994C40E34747161E4E76264DEEF2A3019389D1594C942301AF47B7544C23ECDA2DF2DECE81E487D8F3F58EA89CD811D7275807FF1B0369BA86470088C174A3099FDAFBE5FBB4D158801053B2B435D54059E26DEE76D10A7A372F06B0B88B985B32F52052387438BE8DC8BC6AE7369E2DA9AA5E2585F8DE403D091CCB7F790D54DDB34C608B0876F2825E9113BE20A2B85867A01BDA53287AC780BCD8B606D2E6D7712C56CE0142D22FE6B786DE544963E134FECEDFAFB83D763061D799096A59E30D4472E440AE1FAAABDF42640CE69740CEB9CAE1A9612C21931B74AF3F780236123321B205B6EFD6CBB134F4C73D63C0C13E660B59D5920BC33197C355853D8D1CDDC7959F7BC500AC81D985016F5B89A0EEC79B0D9364EAD8E38577C2A6549F2D067CB09438FDB21220AEC80F6E22A476F332A2A4A0B7ACBEB9E078D2B5A92AE84C924F7CB19FC7DF377BEB6546AF97AA985C747CD111A127A674B4C26D89C14485B82E3A498A12D05406FEBD6C4D4B8BC051AB2CB91224B078538374B794B7DD9DDF3AC2B4A671FB7B9CF5ACB78622AE2709EB2DB16943AA24A9C97A81077BC784D25C0EA5991D2DE883798A1F0E78F3361ED6A10DDED81B1D683658331534FD7C01BC0EB00DFC4C3C84F0693046FF806BB200DD7BD4C0E6ABCA3F2934B4814FC0E1F8BE615A2DDA7C8A8D06CF9CE8566B40F4A6543B25BACDDC926863FC0FA2007D6D7BF6D18DC98DF696BD0865BF0BE4C492B8043A32DEF8E3595BA7DA345252F38F95BE10FD7FB899B498FA01B09DE5D5608EABC44A721AA04C4EF1DCB86102AC5F5F79C9708DCF5C5E896EDD8C2C7BDE3FA83E6FFCE22D66174E31657A0B6361585E669D3031952F08631AE1F16FF90B90D0AAD3C6D7E1DD0A9C41AB00A6E1C4F96AF9AC5B79FCF821FFC016CB059245FB78DBE6C633D965AAAB5333BE07195C4B74B18E4600CE783C0A914EF4281016E80A7C9AA92D0FD789879C5E6751125ECB154432311E41CEBD4FAB3A31E4D2CE22D0F8C67737BF8A0DD85FE1349D5079A4D5FEB3FEE9378CA47AE46CC58A3F02038CFD53C4CEE9CC4270CEBC3D115A39C831E8ED41C4DBE4051B51D7872BA0C2BB163E0085201188EAA624A6BEA9400A3A1FCC355A57F15704E61FDA55A5DBAEA8448FA5CB2D377A07F58305AD107E844AB4806E5BF99C1F513EE1D0A2ACC04549F0801742169A77971D0ADBFBFE0DD2EE5D16BC461E35748D1F3F6F4598321E8C49E79E740F990359858D2729DDE007FCB26FDDA9AA6E2EC4BD736F2836E7E4C83440191C849F6A53C72A4F8F830D001EA3B18F3CB4A5BD3CF066032B4932CFD2E62A9B55723FA61C688C935518AF6860CD649BFBF1BF5FDC1F36DCAEFAA157438D1CC8D56A150161511DF82631F5E88E773E4CE263F276B7B3678D4C6FC75311D411C0D01BFDB595BB70552838E1B86517C837D909E772B428599E1FE569F77CE61531FDE6FD31CDCE1BDEE4BA467FCBFBB9FEEAAD99FEF67D4906E036C73662DDCE158D4E5D4635E5D366F79F31A19D1B3DC4A591B0DF194BB06C18147F41D88D1A409BECDFB67EB063D16312266FD51B521BA9115E2E5E2AEAE6EC511CEDE13ED4132FFBE0273F6C7039B3874F058804A54809AF60557A21D9B4B831D04156A7C22DCBCDFE14F62437F449CB5EF12BF4251D485496CD835C0C2BC58BD845963DFA76ECD68519C4BDAF110BE7AB052876DC3407591568C956EA3BF107C90FD5853A292F59A8D4B58B5D3FDDF29BDBEAC36852E3C69766FE460176A801831292B8E88A74A01ECBBE09A7B4D74CFD7FD628841944D9D556DBD60C76F96F07DC53443805EE9AA09365DE4FB8179252C6B099B5DD351FDEFC23DBD8090596C5D208FFD2C5661D8E5612DD574FC69045C769A969E600D77CFE192F1D3AE911289355C585811491B0CCD73692AB158824AB9EDF8AC8193F0B33E6138B72C6DCD5D344F807B3DA92425037DE5EA4EEAD1C795EFFAA145E2ECDD327606EB2609929B9474B2BB04653602555C068385E92F06F29CA613CE5B4404F01AB1805DB0ACAA890330D291F40692DF382509302B6DC8668F2C8F2D3A44FD58DCA26E9802794F73D25B3149E6D576441")
msg = bytes.fromhex(
    "D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8")
Dilithium2.set_drbg_seed(seed)
sig = Dilithium2.sign(sk, msg)
assert Dilithium2.verify(pk, msg, sig)
sm = bytes.fromhex("66AF1F4837B08A2D04BE10BF5D5337D9BCC8973840CBB5F63CFAFA528DB58821BF24C1038C54FF2ACACFA9997F33EB234155EB3506E52907ACA0AF8EAA946D4C5AA162CFA72197691F4A71C71556003707E3CAC85C3F162CC60795AB42FF6F4A0ABF2A6CEE57DB3302985CF6A3E701C687A9984B4BEDBC6508AE8E2FEB0B7A8A1731373C3C5246F8C3D940CB5737C3EF170A73F63B06A765B5F7FE45E4DC5FA65E4398473540D54274B5B97934E2FBBD77A00316E27619B5EA2A18AD4542D75FBB57D906CC0694D39E8590AAB94DC6513B635CE51EF186D5A69F20EDC76479F437BA1F676D49529FF19909D9750FFB0568BD137299747816D4F07A9BDA579B56F9054CBE583266141C33B3153F25B12FDCADEAD75090903D0C029D4E4B4763C42AC3819F55A79E3E288DA0803835424ACFFB1BB55FA7DA0855B455D0447BCE46B444E72A056F4E889860C936BCBE1BF2978ED2833B71ED722E1D15095B1317A9FCDD17865DCF84C4747C3C4B33B94DA8AC6AB479BFEDDBD2CB404B13CE580F0C55C6B8782DE192CABCFE1E211D04D5F38AE9516BE5910FD725D30DC145B8C0BAA091C4A11FE44D62EB72851FE9986F58DBF466D4B2F36509A8189A946A6EBA4D0634A777425721BD736F777ADBB8CD02DB21B9C6DF9C69F9575FBBDF0A67D765F2F2371CD8538A107C2D8DE9726F034BE0417A5C054493C9E671717AD6ADE55EE17E4E6D2C1693D1F019B4F4212DDDC9133A4038C3367D026E8E000C1A465A0E737EF504937BFA645F63AA81B3945C9BA91B2CBB6E96A7FEE850DE61E314F772592B52CF493D51202311EEB49171739D807CE3AB405EC845A63FFB6A3BB46A5711432B2F367124BBECFA64404FE065EBE60864C0148F7850152E80C760D01BBC57E7DBEF9DE65927C24BE17FAED82BEC1B6973D557B8267CA41A850616A6998B0750357DC330EC40447C5170EE751BA8C2101E4F29BF21DB14DCF661526479A947C60C28C7874F76B9E99699CF9DF71A5005622630601B7781CD0E7557A2D6BD0B771A423391C4480B0E8E8AC0CE4F68DB7CC5EEA3524923498685D7C9C45AC9D7B0C3827641C9F257CA6D3ACAF04C59FDE7D3B15D24989D76355E319C433B82E78883DADFA4A5A95FD861D1B6114C583F4915B948C72BA66FFC2AB4713AA05544B23AE7C83C75AB5549994A077086C71A2D7FA3088C8C8C0E0A27F85277A620BCF7A9360AF6964EACD6C44A96C63581E9D576158C406C714ECF7285849CA3265E0857EEF43DBB95546D0CBDE2881725D5E0BEBD45CBAAF80173D2AA96240FE337AC86578538C37510C79FCBF1043D263F167177D723E9D5ABDF56FDBB51B4F578749C3A77E4AB60CA032015968B9BF0D469D73BA4BD66929FDAAC294B910DB9D58D49DDD2D1E7EF9C4EB81361EAE786D839CF2E95E4F9614192A249253C919CE2391022DB95A598BA6BF01A2C7CD0F1609E7FFDE0F87D12FACCD822E0EEF8DE1E0EA0AC1230363EEC1633081AF9905E87C3E56A214A601418FD5C3910D6AD9CC121ED0EDE6FCA0909DDD0CC26D528004A707923D3AC6FEF0110A09D3E329B6F93BC3CDD7D6CD7D62B811D8FAC3848A8969B778FA77DC416B18A7878040CFD4B1D8DB530C7E7F5C859CC56570CD3CA8B4D18358AD737D6B902B24493C33FF9ED6EB2DDC06C928E3E7B790ACAD77BC1FE9EED09D7948C4A5D338408B361B10EAEE9DBCF50BA8867A5F108019F58A0813E6ADE68DED0638493631EE40C8049C34150D91ED3734731777502238E55F01CD88CAAAA25E8ABDDBDBB4BC6554D5A373D610BBCDB05AF600D9C1D9EF1B3D43720F043C106EE93A102EE7F5333C6FD0040ADD9E9D7FAF952FFF2A718D01E45028F228355EAC6A92E626B63521C4990F7FAB6CD2E8FCB74F359CA299AF447FADD9FA5006088A4F041CCCDAC2579DF3B8983257F711245E85539F9D14C4B99D0627FB41543C75B6F76B87F1DC1B6A141DE13BE4CFE133074CBA338063CF76F8647ED5E5482456E6CB3FCEDB9CFE7A762B16182C5408C8F5F13C29CF88772F13FEB8F9E0E051307AF2EA46F37A069275465AD5576887D06CBDF5AC9B9BDBD6895839BEE685DE8B24890B848409A21B38BBDD29C441782BF3A603306153C47345E5F58E8B3B236266A3F215269AA90A59CA2D5EFAB60FD662EBEA0130BB0F6FB1CABC604EB70515BCEABFB4F17ABF40964E527F85EAAA632775DEE85A31CB18D63C8D550596C72FE94E8CD55DF95C2FD10C4CFCF8811A3204C8F5C57204BCCFB457FCDD0F7569C147B416ECE6CFA813DE0F8B7B48F885162FC067EE6E609158607E1843BD5559C3383CD920F833995C5A85F98B6F6BD152B83FD112353C5A97CB6FCA54EA56CE75ABE92DF29531A6118CD31D7E58F3F1B298EAE463035B098D288E314A5A315308DA372BDE335E9E363486B2CE7195F25588FBC3A6C358DFF1BAB71CFC9F82A68DE8AFCF95931BCD8E4C2115BD8D237EB56A3D57BB4C51641C4B5198BB9B65AADBE16063BDB3A67B13B32B6CC13E914E2281724F76A35422E3448E8C3D244C681DC72FC65CF38ED647E40BCA73D01A8F23274CC0619EE9A6CE49DFD8DD639A246B72564AAFC0177AE46BCC3D0829F3F24816BFE809AF5C1286A089369F59606F95F0F27E8800F9DC8EFFEB055731CF75F01533B2508B88A4B628936F021CA20276DC46C677CC22EEE6AE22245A2616DB14E0D84CE4F58B0E81C51AC330FF5925B5E5EA75D753A34D6DA010DDB5874787FCC02C9AE4EEA39FE47268B04AF9B57C50C7DD03008A4C9BFF3973E51A5CD1CFD970C6DA8438D1D9BA3CD197A0029FF94D02157391CA4DA1EBD3AC11AD701C71CEFF7B0DC245C2D9ECA1C27C55816CA5740D688F92E4F64147C32D6EB6FF2A54B1D1995A31C8C81A0CB709FB760B184392A48991D3F80D69A272A7AA8F829C12244F4A5418EF36D40FBC6BEA4E33A1AAAA6D2361E03D2487AAFFE6BBE42B56BEFE78C35F2A8367AD83A67EE99316C496F94CF17D3D35B0FB371868C19C991B721F59DE6641880A59045E2FFB182E0F51C9E536D7C72CEC698975A0D06187C0EF38B716AAA71BA701678A3CF51D8AA33C944C767ED07249B894699A650F57B7CA56B6D77CE4C79496ACBE340F7792CA4116F7CCE12BCC0AEC3642DE421AA91860BA042D4DAE4DCCFBDC3CD2C72ABEE2B005307565FF4B33CEC2F112DC83B509AE88D31A421ABA7830F1A1E2B3DF212A550890D469827ACFDC6020C91234D2D18A6B266262E689689E268D4617B59B11F3842506FC5EAF53DC80172F0911B284855A1A3A4AAAEB0B1E2E6FC1F3045484B5960728C93B2C5DCE8FF0E1E3138415890AEB8CC122529737A898FA5A9ACDAEBEEF1F200000000000000000000000000000000000000000000000000000E1D2736D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8")
print(sig.hex())
print()
# print(sm.hex())
assert sig + msg == sm
