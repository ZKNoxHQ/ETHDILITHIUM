// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;
//  Code obtained from `generate_test_vectors.py` python file

import {Test, console} from "forge-std/Test.sol";
import {unpackZ} from "../src/ZKNOX_dilithium_core.sol";

contract DilithiumCoreTest is Test {
    function testUnpackZ() public view {
        // input
        bytes memory zBytes =
            hex"ce18f9bbaad06f7b2c2540fd3eae02725bf64b19f7ccf6ec1a909c5c0d4eb46114867ea108480adb6f195b8a2cbde0f1857698746d4566149b8cc209fb43360f6b0cbf1116209a88c69248f1a17fdc72a14c821c8257306edac8f821ca23b3c3eef1a8eb229c450ab25b7608c0fe8e2d1c5cea432821eef64d61cf5f3dad6921cde0b4e59c34b35b7ab449a6367947f37756b319ec7136db2b88a7cd10ac0f16b0e6514bad8438ddf9f111ce4db74d747b576b9cb0be05edbcffad0a1fb79e8db47b5081433f04e85e132315b924a1fa90d2612e6c2e04cae881cb23217643ee6f6bc8a1b5eeaf032a58ddc8a0185d0375a9892cfa3a077fe320467beedfff4a5f46a09591056b63489cfac8b1053269f26b4b66a80e7b637a079cad6afd1565b492048a5622828445035f4f934c3c056282814af5d7044680be588ffc9d92beecf8155168b23dda02249e3be494757e59d127b4023b7135ae96013b66bb22f45efb7fd6b32106a6120a54af5ab790b6a9b73a70c74921310a4044fdd56856e69d91b7033182ec1d939e5f5d96799be6e009ccb23995dbc86f998ee92f1f5768ee3f000ca7d64d2ce43c40e7d277106ddd9ce78f31cc9907f1a774c597ffa377ebecee475ed592590a91dc6086cb1f94fdc6ffd934b80e1b34a52276138b73e7288d4b8312d4b54208acabfbe43ad5c29f6d673aeea5dfd7ccb047212fbcf1f4d4d63f99ed3822035a9f385fd92f1fa9e14f349b87e5cf9ec86be5e02fb7b63a17c42d74e3ef1c810f90f3a0c41564b5829cc0ecbc9844a16d4a4537a7c2492707fdeae0ef739658c9ba5fc0d9a99f8a6275e123f4eabe1079800043f255b0fe126cb2ed6ce9305d10cf571abe8a7cf6d7b0c342d2a84865a9fba1a6f64cf489043f32b4e2ea2c45dc38efe968cdd43703c5550cc35266712c92824e6ca3ebbea077b737c11b057ec7ec382627d51540282a65101506a992d5b6e671fa2d504a25bc63f15880d417a98f0a3fe66a6bfbaac8b1a7ff8662ae5d3c75be139926803c7b696bc874c65ad7c92345401da4dce411ef1424bd8c44e42c94b7a4587df1221359a8bd7ddfad42e09bfcb446b165fca5520db0783ee4bb6eb7a5d0ba05781e8e6e7c986cd2bd8d5bb7ff78e9000eb798702f12cb45cb60519042805f04bb8ca978249af6bf028387d51a1c21cc86e4a505be949402504af7c30abdae8bdb282219685814a4af4eb6f7702a270fe8f10562d4964422294349cba1f7ea7d3c60f94b0c191090d7430a6cf66b342f0bbff8984d7c627e72b8f5b931ba67c11aa65795ba2ee8e5f784156a588467522d87b31b5b7cec6beabd5f11b3796a72f817c6d13d70eeb5079471eaf6fa8d3a988237f7f8b0ed85b482836d6cb3cfe530d3c8b31f2c07589f479bd9d5b2bb8bf2fc4fe568bff11e4ef367725114a99fe8dd96452c01064e7ecfe50973c8a2a688927795b2c66da2a7c8a643435e96fb0a59aa33b757f557d4d8e81d13eadcb2547e98fb4377490027f446a23b58920f66ba767608458682181249bdd7ec007c9ada09c808ec79d099c44f8f5094b5b6291fb2df026fcc0b9c5be0f632a4dbf0c53a7f6c842636958d2d83c10e9998dbcc60f29d54bafbcd867c5abd186a5e74b19d785f6ced5f6ca59a5b7c7a213afec5b8ed04b519106a410176d07a4eb1c717e4611581e79d5e9c5c43cd13793c06cb606b7f487305c11113b054fb0e8ffda36c93202499a503eeb23a2006058cfaca0052589b31b9aad4a10393875e2714a5d6e67f29c004122848e29dc1c081f16df971f0dd0f9d046f6045cda17919b5b808bb6d3c932d4df6c3685e508308391cfa8a1a3e9cf8103af71b67e41d7142704338867a2ca0187153df7887cc52e8d577850afc07dee8cd2110e71a29efe1be0cfbe80eb297559658be54b53bc4b9bde91836170c061c8b8930d020757b4231ddc95922acbb899a237beb946a131722bb470174876ab809394dbe82a342a959a162db215187c3760700af96eb0c506bfc21ee8a1619407685d3d1db7930c3ec9f6ca190872aabd61a8f7abc5cdde0dccc3a3db92e791ae8f9170a9795830caaf764691b5f29552517ed35698b43055216e8222f54802a9b8838224424995e0c47df0c36f2a7ccfc65082ce5b33195fbd28e06626d6674c7ed5ebb2be601106298dc6ac020eaceb1b69cbbdf665d479f1d0911dcc9ba66581ba8c2721c0500e6b5638f1f260ca536eb9f535ce185e6535f7999cd569f358fe238c4db56638d78cef5454fe20806ea4d4605391f399d2e38ac9dbc7e5ee4c39c18f7ed21c9d845bf4824a7d948c8875fb38a8857b434cb6c1a53f39710c6c3ead3f4acb83f37ef9cd7ec4b6b5a67553ae0c60699a276f14c1d6d8d5070130f5e892b3783316d96f744f8276b77473afb4c76712c731867db25ff51fce6d9ff47e912ebb4f92fef441b1dc8f15e4aaeba70da16747a86176d7347655e67da6193ee1a34b86c2f4194c775936eb45779fa9810b0223f938568815afe9d2da1c34d6f430414862586992bf4c0c14597092e519ca40b5368c89b98e0a7d24bb0f053684f4395fbdd9cf372b4b20dbdbb7b9127992e41db0aa7b2e69527132ef808d75dd1c651d611c7a7011ff85dafebd7d3b0ef55146eea29518fd9d5e014216aac85ec312a525098d20b6902897ba5e49278068b898beb9a05f3e98f37cf4a30165f29a1a05ab3f75573200edc6e7748128d2a3072dc4e14c24c31850a63e47765457b3e377f4dd129fdf257e70b6da62ff90ce0c16ce4483bfa4f5df3c67878829729ef452bc93c61dc1a8aa7577fe7e4157617b4b23fbb0f6813b9bd5a4ec7894e104d5ee8ad1330c8e08e95e4eb50f9d3844a70c9d54ded14cdf6a7d0c20fe5b2c9fead6cd7046621152fb2aae186a9238880f61acc00128245bc63e7abeb97cc0e8ad33337c8aa60b3a235af440f929d3cffe98ea3fd31a8adcd58ffb71d49d2064bce08d0fa32d2eb6707c6c6ba585055d696bba931b2e969ded79c5985df5a952f58349f8e2227ef5195b2eec707824f4aebbe6d8e9b7ff90333e4e27306f3e991b95a67fc962e28c2533e32138240b1bb5d90182f4caac720817c1b9c457dca113ba5172545f7595a05f0e90dfc84831e0c5e5daec9df5513487b9f7092caed56ea8e15d79f1f4f04e3fa61d336cfa5ec4d1b77bf577aa8c96c44582f25a25e983da04e9c506892817b3e90aa035283ffbe7205e8";
        // output
        uint256[][] memory z = new uint256[][](4);
        for (uint256 i = 0; i < 4; i++) {
            z[i] = new uint256[](256);
        }

        z[0][0] = 59186;
        z[0][1] = 8335619;
        z[0][2] = 8315639;
        z[0][3] = 85523;
        z[0][4] = 49115;
        z[0][5] = 8278082;
        z[0][6] = 8306647;
        z[0][7] = 8259220;
        z[0][8] = 8308406;
        z[0][9] = 19651;
        z[0][10] = 20785;
        z[0][11] = 8351169;
        z[0][12] = 8376997;
        z[0][13] = 103149;
        z[0][14] = 106170;
        z[0][15] = 8346119;
        z[0][16] = 8361977;
        z[0][17] = 8251711;
        z[0][18] = 20074;
        z[0][19] = 85463;
        z[0][20] = 8003;
        z[0][21] = 24196;
        z[0][22] = 8296058;
        z[0][23] = 59979;
        z[0][24] = 8309659;
        z[0][25] = 89306;
        z[0][26] = 8269669;
        z[0][27] = 75505;
        z[0][28] = 103665;
        z[0][29] = 102461;
        z[0][30] = 8380064;
        z[0][31] = 8371609;
        z[0][32] = 93498;
        z[0][33] = 99246;
        z[0][34] = 14342;
        z[0][35] = 8346166;
        z[0][36] = 97716;
        z[0][37] = 8057;
        z[0][38] = 8322300;
        z[0][39] = 8305816;
        z[0][40] = 8371721;
        z[0][41] = 79630;
        z[0][42] = 8319942;
        z[0][43] = 8338490;
        z[0][44] = 122133;
        z[0][45] = 8343194;
        z[0][46] = 17632;
        z[0][47] = 122407;
        z[0][48] = 8315201;
        z[0][49] = 8311966;
        z[0][50] = 8337984;
        z[0][51] = 89841;
        z[0][52] = 8319456;
        z[0][53] = 109699;
        z[0][54] = 778;
        z[0][55] = 8334092;
        z[0][56] = 56983;
        z[0][57] = 51149;
        z[0][58] = 12709;
        z[0][59] = 8327983;
        z[0][60] = 99749;
        z[0][61] = 28051;
        z[0][62] = 8277143;
        z[0][63] = 8262372;
        z[0][64] = 8292746;
        z[0][65] = 8313237;
        z[0][66] = 8288483;
        z[0][67] = 86164;
        z[0][68] = 22648;
        z[0][69] = 8313806;
        z[0][70] = 40710;
        z[0][71] = 8275265;
        z[0][72] = 46255;
        z[0][73] = 8371926;
        z[0][74] = 8274478;
        z[0][75] = 112697;
        z[0][76] = 8294963;
        z[0][77] = 60563;
        z[0][78] = 34889;
        z[0][79] = 8351316;
        z[0][80] = 16720;
        z[0][81] = 8299712;
        z[0][82] = 8323078;
        z[0][83] = 99286;
        z[0][84] = 24905;
        z[0][85] = 8319710;
        z[0][86] = 125689;
        z[0][87] = 66290;
        z[0][88] = 8321021;
        z[0][89] = 80681;
        z[0][90] = 8277679;
        z[0][91] = 8346479;
        z[0][92] = 8343303;
        z[0][93] = 8275853;
        z[0][94] = 8321343;
        z[0][95] = 8304625;
        z[0][96] = 8281625;
        z[0][97] = 112398;
        z[0][98] = 116894;
        z[0][99] = 16455;
        z[0][100] = 14229;
        z[0][101] = 8270489;
        z[0][102] = 115970;
        z[0][103] = 40792;
        z[0][104] = 79651;
        z[0][105] = 8296921;
        z[0][106] = 8294348;
        z[0][107] = 8370524;
        z[0][108] = 8316373;
        z[0][109] = 8265267;
        z[0][110] = 8376778;
        z[0][111] = 4840;
        z[0][112] = 8257555;
        z[0][113] = 8260930;
        z[0][114] = 8379292;
        z[0][115] = 8362411;
        z[0][116] = 8287484;
        z[0][117] = 8310249;
        z[0][118] = 94295;
        z[0][119] = 125241;
        z[0][120] = 8353487;
        z[0][121] = 8324357;
        z[0][122] = 8346013;
        z[0][123] = 5062;
        z[0][124] = 8283550;
        z[0][125] = 8288512;
        z[0][126] = 8259927;
        z[0][127] = 27561;
        z[0][128] = 93516;
        z[0][129] = 23935;
        z[0][130] = 122331;
        z[0][131] = 59886;
        z[0][132] = 8290558;
        z[0][133] = 8305454;
        z[0][134] = 109628;
        z[0][135] = 8377977;
        z[0][136] = 46463;
        z[0][137] = 51715;
        z[0][138] = 129952;
        z[0][139] = 40198;
        z[0][140] = 881;
        z[0][141] = 8272730;
        z[0][142] = 8278326;
        z[0][143] = 48041;
        z[0][144] = 19864;
        z[0][145] = 84337;
        z[0][146] = 7616;
        z[0][147] = 8277779;
        z[0][148] = 8350317;
        z[0][149] = 108961;
        z[0][150] = 8297860;
        z[0][151] = 70646;
        z[0][152] = 8366736;
        z[0][153] = 105045;
        z[0][154] = 8354897;
        z[0][155] = 95507;
        z[0][156] = 8290573;
        z[0][157] = 24578;
        z[0][158] = 8373444;
        z[0][159] = 8341481;
        z[0][160] = 128494;
        z[0][161] = 8336428;
        z[0][162] = 62603;
        z[0][163] = 8337703;
        z[0][164] = 116041;
        z[0][165] = 8351269;
        z[0][166] = 8310253;
        z[0][167] = 65496;
        z[0][168] = 700;
        z[0][169] = 26059;
        z[0][170] = 8603;
        z[0][171] = 8323515;
        z[0][172] = 8367870;
        z[0][173] = 8283361;
        z[0][174] = 5839;
        z[0][175] = 35458;
        z[0][176] = 8283755;
        z[0][177] = 116314;
        z[0][178] = 81762;
        z[0][179] = 71989;
        z[0][180] = 74859;
        z[0][181] = 8356879;
        z[0][182] = 8341272;
        z[0][183] = 99137;
        z[0][184] = 8353706;
        z[0][185] = 126981;
        z[0][186] = 8351553;
        z[0][187] = 51366;
        z[0][188] = 72660;
        z[0][189] = 12273;
        z[0][190] = 8282835;
        z[0][191] = 19391;
        z[0][192] = 8274724;
        z[0][193] = 105479;
        z[0][194] = 25405;
        z[0][195] = 8264675;
        z[0][196] = 35673;
        z[0][197] = 8256016;
        z[0][198] = 8283586;
        z[0][199] = 8268884;
        z[0][200] = 8362003;
        z[0][201] = 84649;
        z[0][202] = 88679;
        z[0][203] = 8285629;
        z[0][204] = 8280481;
        z[0][205] = 63502;
        z[0][206] = 102439;
        z[0][207] = 8288258;
        z[0][208] = 8333261;
        z[0][209] = 63805;
        z[0][210] = 8369582;
        z[0][211] = 111144;
        z[0][212] = 8285302;
        z[0][213] = 8295880;
        z[0][214] = 117576;
        z[0][215] = 8294327;
        z[0][216] = 113995;
        z[0][217] = 8320255;
        z[0][218] = 8360007;
        z[0][219] = 8293142;
        z[0][220] = 24638;
        z[0][221] = 8341030;
        z[0][222] = 8356126;
        z[0][223] = 8290435;
        z[0][224] = 8269621;
        z[0][225] = 8263600;
        z[0][226] = 8307775;
        z[0][227] = 8293422;
        z[0][228] = 49194;
        z[0][229] = 8365211;
        z[0][230] = 118237;
        z[0][231] = 8348313;
        z[0][232] = 41160;
        z[0][233] = 8262667;
        z[0][234] = 8373616;
        z[0][235] = 77505;
        z[0][236] = 30821;
        z[0][237] = 8268808;
        z[0][238] = 8332152;
        z[0][239] = 8281196;
        z[0][240] = 8333522;
        z[0][241] = 12627;
        z[0][242] = 8324032;
        z[0][243] = 8278577;
        z[0][244] = 58129;
        z[0][245] = 130080;
        z[0][246] = 8376520;
        z[0][247] = 108782;
        z[0][248] = 8333981;
        z[0][249] = 121056;
        z[0][250] = 8261941;
        z[0][251] = 60830;
        z[0][252] = 8352352;
        z[0][253] = 11950;
        z[0][254] = 120205;
        z[0][255] = 90841;
        z[1][0] = 8315642;
        z[1][1] = 8251335;
        z[1][2] = 39106;
        z[1][3] = 8305311;
        z[1][4] = 106566;
        z[1][5] = 8350097;
        z[1][6] = 87558;
        z[1][7] = 10870;
        z[1][8] = 121887;
        z[1][9] = 8267076;
        z[1][10] = 8277750;
        z[1][11] = 130559;
        z[1][12] = 3517;
        z[1][13] = 8270828;
        z[1][14] = 8330962;
        z[1][15] = 8268088;
        z[1][16] = 71316;
        z[1][17] = 125108;
        z[1][18] = 33551;
        z[1][19] = 8316824;
        z[1][20] = 8348535;
        z[1][21] = 117251;
        z[1][22] = 119749;
        z[1][23] = 8338616;
        z[1][24] = 39608;
        z[1][25] = 98582;
        z[1][26] = 8287639;
        z[1][27] = 8261326;
        z[1][28] = 8313720;
        z[1][29] = 62321;
        z[1][30] = 8335830;
        z[1][31] = 60237;
        z[1][32] = 8300325;
        z[1][33] = 8365446;
        z[1][34] = 45866;
        z[1][35] = 127777;
        z[1][36] = 109115;
        z[1][37] = 85821;
        z[1][38] = 8309148;
        z[1][39] = 8361808;
        z[1][40] = 110974;
        z[1][41] = 8320806;
        z[1][42] = 8377363;
        z[1][43] = 8323619;
        z[1][44] = 8265418;
        z[1][45] = 8281787;
        z[1][46] = 8328074;
        z[1][47] = 91933;
        z[1][48] = 10969;
        z[1][49] = 8376316;
        z[1][50] = 8359263;
        z[1][51] = 109503;
        z[1][52] = 8337147;
        z[1][53] = 19100;
        z[1][54] = 8307094;
        z[1][55] = 83991;
        z[1][56] = 46512;
        z[1][57] = 69879;
        z[1][58] = 28906;
        z[1][59] = 8293888;
        z[1][60] = 8271594;
        z[1][61] = 8265054;
        z[1][62] = 8335774;
        z[1][63] = 8254036;
        z[1][64] = 14166;
        z[1][65] = 8254997;
        z[1][66] = 8370066;
        z[1][67] = 35143;
        z[1][68] = 8350405;
        z[1][69] = 8362770;
        z[1][70] = 130455;
        z[1][71] = 4878;
        z[1][72] = 103575;
        z[1][73] = 25294;
        z[1][74] = 35412;
        z[1][75] = 94425;
        z[1][76] = 49083;
        z[1][77] = 8304378;
        z[1][78] = 57779;
        z[1][79] = 109636;
        z[1][80] = 82652;
        z[1][81] = 61149;
        z[1][82] = 48434;
        z[1][83] = 8342819;
        z[1][84] = 33448;
        z[1][85] = 79684;
        z[1][86] = 8346224;
        z[1][87] = 2314;
        z[1][88] = 8335906;
        z[1][89] = 8316913;
        z[1][90] = 8294456;
        z[1][91] = 8329959;
        z[1][92] = 923;
        z[1][93] = 8293208;
        z[1][94] = 8279297;
        z[1][95] = 8277768;
        z[1][96] = 8286534;
        z[1][97] = 120467;
        z[1][98] = 107603;
        z[1][99] = 99872;
        z[1][100] = 102770;
        z[1][101] = 8305122;
        z[1][102] = 8258267;
        z[1][103] = 37322;
        z[1][104] = 65609;
        z[1][105] = 116130;
        z[1][106] = 8285985;
        z[1][107] = 15774;
        z[1][108] = 8310226;
        z[1][109] = 8326799;
        z[1][110] = 59892;
        z[1][111] = 62911;
        z[1][112] = 106624;
        z[1][113] = 8302912;
        z[1][114] = 8279401;
        z[1][115] = 8353648;
        z[1][116] = 8331275;
        z[1][117] = 8000;
        z[1][118] = 21160;
        z[1][119] = 97168;
        z[1][120] = 96564;
        z[1][121] = 38535;
        z[1][122] = 46112;
        z[1][123] = 128430;
        z[1][124] = 8295857;
        z[1][125] = 8335108;
        z[1][126] = 8320049;
        z[1][127] = 8286675;
        z[1][128] = 56792;
        z[1][129] = 8373755;
        z[1][130] = 8363708;
        z[1][131] = 50498;
        z[1][132] = 67658;
        z[1][133] = 13668;
        z[1][134] = 8347407;
        z[1][135] = 124985;
        z[1][136] = 8326047;
        z[1][137] = 93915;
        z[1][138] = 118126;
        z[1][139] = 8303324;
        z[1][140] = 8317024;
        z[1][141] = 8306823;
        z[1][142] = 8276478;
        z[1][143] = 118481;
        z[1][144] = 126951;
        z[1][145] = 68124;
        z[1][146] = 8331101;
        z[1][147] = 20519;
        z[1][148] = 8302797;
        z[1][149] = 8368191;
        z[1][150] = 75377;
        z[1][151] = 30223;
        z[1][152] = 101762;
        z[1][153] = 8348307;
        z[1][154] = 8273126;
        z[1][155] = 8313443;
        z[1][156] = 8272359;
        z[1][157] = 8338092;
        z[1][158] = 8346902;
        z[1][159] = 8257642;
        z[1][160] = 8374909;
        z[1][161] = 59878;
        z[1][162] = 55688;
        z[1][163] = 8373068;
        z[1][164] = 8307790;
        z[1][165] = 8306923;
        z[1][166] = 8337731;
        z[1][167] = 33033;
        z[1][168] = 19695;
        z[1][169] = 91490;
        z[1][170] = 32889;
        z[1][171] = 8296681;
        z[1][172] = 8351684;
        z[1][173] = 4741;
        z[1][174] = 8308417;
        z[1][175] = 8258648;
        z[1][176] = 8344071;
        z[1][177] = 88562;
        z[1][178] = 8285321;
        z[1][179] = 8330270;
        z[1][180] = 96787;
        z[1][181] = 73555;
        z[1][182] = 8329513;
        z[1][183] = 8298804;
        z[1][184] = 8302364;
        z[1][185] = 69068;
        z[1][186] = 8330758;
        z[1][187] = 40932;
        z[1][188] = 8296546;
        z[1][189] = 35226;
        z[1][190] = 8266964;
        z[1][191] = 8263123;
        z[1][192] = 45060;
        z[1][193] = 8259016;
        z[1][194] = 4325;
        z[1][195] = 8262345;
        z[1][196] = 36249;
        z[1][197] = 8362733;
        z[1][198] = 8345095;
        z[1][199] = 8357002;
        z[1][200] = 54203;
        z[1][201] = 8281729;
        z[1][202] = 67612;
        z[1][203] = 120937;
        z[1][204] = 8329102;
        z[1][205] = 8369753;
        z[1][206] = 8283865;
        z[1][207] = 8328620;
        z[1][208] = 8352315;
        z[1][209] = 8369689;
        z[1][210] = 116116;
        z[1][211] = 34547;
        z[1][212] = 8316011;
        z[1][213] = 8341951;
        z[1][214] = 8285383;
        z[1][215] = 8260259;
        z[1][216] = 76713;
        z[1][217] = 8283595;
        z[1][218] = 8339152;
        z[1][219] = 8328334;
        z[1][220] = 98732;
        z[1][221] = 65818;
        z[1][222] = 92300;
        z[1][223] = 91135;
        z[1][224] = 8362253;
        z[1][225] = 8376601;
        z[1][226] = 67291;
        z[1][227] = 8320617;
        z[1][228] = 100746;
        z[1][229] = 28350;
        z[1][230] = 30680;
        z[1][231] = 56248;
        z[1][232] = 75843;
        z[1][233] = 8314822;
        z[1][234] = 22105;
        z[1][235] = 8306650;
        z[1][236] = 5112;
        z[1][237] = 8350691;
        z[1][238] = 66487;
        z[1][239] = 48579;
        z[1][240] = 8333933;
        z[1][241] = 8263060;
        z[1][242] = 1247;
        z[1][243] = 17397;
        z[1][244] = 128052;
        z[1][245] = 125209;
        z[1][246] = 8302739;
        z[1][247] = 8286577;
        z[1][248] = 8329745;
        z[1][249] = 8306739;
        z[1][250] = 8353723;
        z[1][251] = 8358697;
        z[1][252] = 8303220;
        z[1][253] = 8269729;
        z[1][254] = 30320;
        z[1][255] = 8301715;
        z[2][0] = 3488;
        z[2][1] = 8342234;
        z[2][2] = 73797;
        z[2][3] = 3557;
        z[2][4] = 82598;
        z[2][5] = 8275323;
        z[2][6] = 8308924;
        z[2][7] = 7562;
        z[2][8] = 37793;
        z[2][9] = 8308742;
        z[2][10] = 21930;
        z[2][11] = 3730;
        z[2][12] = 8371847;
        z[2][13] = 32882;
        z[2][14] = 8324213;
        z[2][15] = 8326126;
        z[2][16] = 8376296;
        z[2][17] = 110502;
        z[2][18] = 63648;
        z[2][19] = 50709;
        z[2][20] = 8263760;
        z[2][21] = 100091;
        z[2][22] = 126634;
        z[2][23] = 8349795;
        z[2][24] = 91042;
        z[2][25] = 8294186;
        z[2][26] = 8277701;
        z[2][27] = 124687;
        z[2][28] = 8290102;
        z[2][29] = 8372263;
        z[2][30] = 108748;
        z[2][31] = 112892;
        z[2][32] = 85997;
        z[2][33] = 8266028;
        z[2][34] = 8259345;
        z[2][35] = 19825;
        z[2][36] = 122733;
        z[2][37] = 39351;
        z[2][38] = 8323015;
        z[2][39] = 70965;
        z[2][40] = 63968;
        z[2][41] = 8338688;
        z[2][42] = 127825;
        z[2][43] = 40632;
        z[2][44] = 52837;
        z[2][45] = 54610;
        z[2][46] = 116195;
        z[2][47] = 8372661;
        z[2][48] = 120994;
        z[2][49] = 22203;
        z[2][50] = 8249748;
        z[2][51] = 8314716;
        z[2][52] = 126460;
        z[2][53] = 93686;
        z[2][54] = 124450;
        z[2][55] = 8378622;
        z[2][56] = 37391;
        z[2][57] = 123778;
        z[2][58] = 66081;
        z[2][59] = 126348;
        z[2][60] = 40849;
        z[2][61] = 101551;
        z[2][62] = 26726;
        z[2][63] = 8322349;
        z[2][64] = 17656;
        z[2][65] = 78053;
        z[2][66] = 77095;
        z[2][67] = 8310824;
        z[2][68] = 106904;
        z[2][69] = 8372013;
        z[2][70] = 15472;
        z[2][71] = 8369177;
        z[2][72] = 115174;
        z[2][73] = 115161;
        z[2][74] = 8285280;
        z[2][75] = 25489;
        z[2][76] = 57884;
        z[2][77] = 126820;
        z[2][78] = 8281034;
        z[2][79] = 5608;
        z[2][80] = 90068;
        z[2][81] = 74682;
        z[2][82] = 8278540;
        z[2][83] = 8302052;
        z[2][84] = 6062;
        z[2][85] = 41483;
        z[2][86] = 8265561;
        z[2][87] = 8284130;
        z[2][88] = 12824;
        z[2][89] = 15352;
        z[2][90] = 8343123;
        z[2][91] = 8280133;
        z[2][92] = 8311619;
        z[2][93] = 8267203;
        z[2][94] = 34016;
        z[2][95] = 8357547;
        z[2][96] = 82344;
        z[2][97] = 8319660;
        z[2][98] = 8274878;
        z[2][99] = 8272139;
        z[2][100] = 8301033;
        z[2][101] = 31995;
        z[2][102] = 85568;
        z[2][103] = 81370;
        z[2][104] = 57136;
        z[2][105] = 90403;
        z[2][106] = 11500;
        z[2][107] = 39129;
        z[2][108] = 8270815;
        z[2][109] = 8338835;
        z[2][110] = 8269256;
        z[2][111] = 8358996;
        z[2][112] = 8309911;
        z[2][113] = 8329084;
        z[2][114] = 125829;
        z[2][115] = 8372785;
        z[2][116] = 18326;
        z[2][117] = 8294847;
        z[2][118] = 119836;
        z[2][119] = 62834;
        z[2][120] = 42583;
        z[2][121] = 8324953;
        z[2][122] = 60899;
        z[2][123] = 8311268;
        z[2][124] = 129162;
        z[2][125] = 21568;
        z[2][126] = 78151;
        z[2][127] = 21184;
        z[2][128] = 8371717;
        z[2][129] = 23877;
        z[2][130] = 130671;
        z[2][131] = 8374824;
        z[2][132] = 8261166;
        z[2][133] = 123274;
        z[2][134] = 8328142;
        z[2][135] = 19841;
        z[2][136] = 8277856;
        z[2][137] = 8328544;
        z[2][138] = 21142;
        z[2][139] = 5572;
        z[2][140] = 41796;
        z[2][141] = 8300490;
        z[2][142] = 8270644;
        z[2][143] = 8321805;
        z[2][144] = 8349395;
        z[2][145] = 8349179;
        z[2][146] = 89729;
        z[2][147] = 8358309;
        z[2][148] = 8377214;
        z[2][149] = 49686;
        z[2][150] = 18794;
        z[2][151] = 88708;
        z[2][152] = 8305324;
        z[2][153] = 33979;
        z[2][154] = 84333;
        z[2][155] = 125682;
        z[2][156] = 125358;
        z[2][157] = 8263495;
        z[2][158] = 129726;
        z[2][159] = 8352599;
        z[2][160] = 8365945;
        z[2][161] = 61176;
        z[2][162] = 5742;
        z[2][163] = 58319;
        z[2][164] = 8377122;
        z[2][165] = 883;
        z[2][166] = 8262455;
        z[2][167] = 122473;
        z[2][168] = 8256213;
        z[2][169] = 45972;
        z[2][170] = 53319;
        z[2][171] = 124357;
        z[2][172] = 8352415;
        z[2][173] = 8935;
        z[2][174] = 4388;
        z[2][175] = 86291;
        z[2][176] = 130586;
        z[2][177] = 8374141;
        z[2][178] = 8335928;
        z[2][179] = 97535;
        z[2][180] = 12566;
        z[2][181] = 8303189;
        z[2][182] = 1095;
        z[2][183] = 35429;
        z[2][184] = 24761;
        z[2][185] = 114105;
        z[2][186] = 90687;
        z[2][187] = 25877;
        z[2][188] = 124072;
        z[2][189] = 85846;
        z[2][190] = 110137;
        z[2][191] = 8275969;
        z[2][192] = 8289356;
        z[2][193] = 30749;
        z[2][194] = 8359743;
        z[2][195] = 8270631;
        z[2][196] = 109665;
        z[2][197] = 34729;
        z[2][198] = 49560;
        z[2][199] = 6787;
        z[2][200] = 8327784;
        z[2][201] = 38955;
        z[2][202] = 8369934;
        z[2][203] = 8310558;
        z[2][204] = 8292646;
        z[2][205] = 8371369;
        z[2][206] = 8291098;
        z[2][207] = 49897;
        z[2][208] = 8378143;
        z[2][209] = 8283520;
        z[2][210] = 109468;
        z[2][211] = 99100;
        z[2][212] = 8340168;
        z[2][213] = 8311286;
        z[2][214] = 8263207;
        z[2][215] = 34310;
        z[2][216] = 80924;
        z[2][217] = 14809;
        z[2][218] = 8372514;
        z[2][219] = 8289501;
        z[2][220] = 82107;
        z[2][221] = 14062;
        z[2][222] = 94822;
        z[2][223] = 8372448;
        z[2][224] = 8334498;
        z[2][225] = 7646;
        z[2][226] = 8295612;
        z[2][227] = 19668;
        z[2][228] = 8293607;
        z[2][229] = 121348;
        z[2][230] = 115615;
        z[2][231] = 8294486;
        z[2][232] = 86796;
        z[2][233] = 12306;
        z[2][234] = 12557;
        z[2][235] = 8268963;
        z[2][236] = 8352950;
        z[2][237] = 42538;
        z[2][238] = 8379484;
        z[2][239] = 124133;
        z[2][240] = 8338792;
        z[2][241] = 8299428;
        z[2][242] = 8326701;
        z[2][243] = 48587;
        z[2][244] = 8309905;
        z[2][245] = 8358014;
        z[2][246] = 8285513;
        z[2][247] = 80372;
        z[2][248] = 8276372;
        z[2][249] = 8376004;
        z[2][250] = 8334722;
        z[2][251] = 57891;
        z[2][252] = 66758;
        z[2][253] = 107117;
        z[2][254] = 8301882;
        z[2][255] = 25503;
        z[3][0] = 8305190;
        z[3][1] = 8309634;
        z[3][2] = 24977;
        z[3][3] = 57345;
        z[3][4] = 8310040;
        z[3][5] = 8352455;
        z[3][6] = 8318210;
        z[3][7] = 103149;
        z[3][8] = 14307;
        z[3][9] = 8341573;
        z[3][10] = 8271133;
        z[3][11] = 8287807;
        z[3][12] = 8350699;
        z[3][13] = 7778;
        z[3][14] = 8300848;
        z[3][15] = 27363;
        z[3][16] = 8353955;
        z[3][17] = 75658;
        z[3][18] = 20759;
        z[3][19] = 8322865;
        z[3][20] = 53396;
        z[3][21] = 6896;
        z[3][22] = 51364;
        z[3][23] = 8326727;
        z[3][24] = 8349354;
        z[3][25] = 121282;
        z[3][26] = 8369408;
        z[3][27] = 8360709;
        z[3][28] = 38779;
        z[3][29] = 8276321;
        z[3][30] = 8324642;
        z[3][31] = 8311165;
        z[3][32] = 8286388;
        z[3][33] = 65264;
        z[3][34] = 8357792;
        z[3][35] = 8354281;
        z[3][36] = 68565;
        z[3][37] = 36752;
        z[3][38] = 91788;
        z[3][39] = 47944;
        z[3][40] = 8272741;
        z[3][41] = 8375103;
        z[3][42] = 17274;
        z[3][43] = 8281503;
        z[3][44] = 8260954;
        z[3][45] = 119790;
        z[3][46] = 8346306;
        z[3][47] = 62147;
        z[3][48] = 1131;
        z[3][49] = 71881;
        z[3][50] = 8296658;
        z[3][51] = 117046;
        z[3][52] = 8266820;
        z[3][53] = 7074;
        z[3][54] = 8320623;
        z[3][55] = 8286973;
        z[3][56] = 8337655;
        z[3][57] = 34388;
        z[3][58] = 52615;
        z[3][59] = 8257353;
        z[3][60] = 10488;
        z[3][61] = 19369;
        z[3][62] = 39652;
        z[3][63] = 8307642;
        z[3][64] = 8314458;
        z[3][65] = 8282618;
        z[3][66] = 8332556;
        z[3][67] = 8294562;
        z[3][68] = 4176;
        z[3][69] = 8280812;
        z[3][70] = 8339803;
        z[3][71] = 8364733;
        z[3][72] = 76327;
        z[3][73] = 113352;
        z[3][74] = 8329567;
        z[3][75] = 8269291;
        z[3][76] = 8369616;
        z[3][77] = 8375277;
        z[3][78] = 82647;
        z[3][79] = 128604;
        z[3][80] = 33911;
        z[3][81] = 83671;
        z[3][82] = 104567;
        z[3][83] = 8370645;
        z[3][84] = 8320118;
        z[3][85] = 81562;
        z[3][86] = 65889;
        z[3][87] = 8299299;
        z[3][88] = 8368055;
        z[3][89] = 8357948;
        z[3][90] = 8377839;
        z[3][91] = 8327831;
        z[3][92] = 8292874;
        z[3][93] = 8280037;
        z[3][94] = 8319553;
        z[3][95] = 56867;
        z[3][96] = 8344303;
        z[3][97] = 95222;
        z[3][98] = 70201;
        z[3][99] = 8312752;
        z[3][100] = 52916;
        z[3][101] = 81247;
        z[3][102] = 8282555;
        z[3][103] = 60011;
        z[3][104] = 8298886;
        z[3][105] = 8290356;
        z[3][106] = 8340205;
        z[3][107] = 8262669;
        z[3][108] = 8255658;
        z[3][109] = 25790;
        z[3][110] = 8277255;
        z[3][111] = 8282062;
        z[3][112] = 103231;
        z[3][113] = 8326600;
        z[3][114] = 65629;
        z[3][115] = 8262284;
        z[3][116] = 100154;
        z[3][117] = 8034;
        z[3][118] = 8318312;
        z[3][119] = 86761;
        z[3][120] = 49975;
        z[3][121] = 8333545;
        z[3][122] = 8349536;
        z[3][123] = 674;
        z[3][124] = 6937;
        z[3][125] = 8827;
        z[3][126] = 8303808;
        z[3][127] = 8319747;
        z[3][128] = 8288242;
        z[3][129] = 8286653;
        z[3][130] = 72277;
        z[3][131] = 8370404;
        z[3][132] = 61362;
        z[3][133] = 8374382;
        z[3][134] = 50466;
        z[3][135] = 8306497;
        z[3][136] = 28960;
        z[3][137] = 8316636;
        z[3][138] = 8276723;
        z[3][139] = 8375474;
        z[3][140] = 36790;
        z[3][141] = 8284815;
        z[3][142] = 45356;
        z[3][143] = 8258765;
        z[3][144] = 8327002;
        z[3][145] = 48144;
        z[3][146] = 91346;
        z[3][147] = 8333318;
        z[3][148] = 75924;
        z[3][149] = 108159;
        z[3][150] = 8318639;
        z[3][151] = 8336697;
        z[3][152] = 31007;
        z[3][153] = 8378135;
        z[3][154] = 8288249;
        z[3][155] = 8302486;
        z[3][156] = 8375809;
        z[3][157] = 8310433;
        z[3][158] = 8350150;
        z[3][159] = 8270162;
        z[3][160] = 8328042;
        z[3][161] = 73085;
        z[3][162] = 8285380;
        z[3][163] = 8336609;
        z[3][164] = 8334497;
        z[3][165] = 8262297;
        z[3][166] = 68534;
        z[3][167] = 8350137;
        z[3][168] = 196;
        z[3][169] = 72774;
        z[3][170] = 8306727;
        z[3][171] = 8333665;
        z[3][172] = 8292148;
        z[3][173] = 8286722;
        z[3][174] = 56175;
        z[3][175] = 54245;
        z[3][176] = 128818;
        z[3][177] = 82252;
        z[3][178] = 8331998;
        z[3][179] = 123489;
        z[3][180] = 8329531;
        z[3][181] = 125394;
        z[3][182] = 39595;
        z[3][183] = 8319398;
        z[3][184] = 8367704;
        z[3][185] = 8349077;
        z[3][186] = 33306;
        z[3][187] = 39309;
        z[3][188] = 8323196;
        z[3][189] = 8256171;
        z[3][190] = 8297087;
        z[3][191] = 8365445;
        z[3][192] = 8304863;
        z[3][193] = 43909;
        z[3][194] = 8320216;
        z[3][195] = 123105;
        z[3][196] = 8360063;
        z[3][197] = 8267055;
        z[3][198] = 71973;
        z[3][199] = 402;
        z[3][200] = 8313864;
        z[3][201] = 83700;
        z[3][202] = 104642;
        z[3][203] = 8271925;
        z[3][204] = 8332912;
        z[3][205] = 8308267;
        z[3][206] = 8320658;
        z[3][207] = 8312673;
        z[3][208] = 8364462;
        z[3][209] = 97076;
        z[3][210] = 8309753;
        z[3][211] = 35090;
        z[3][212] = 8308593;
        z[3][213] = 8342774;
        z[3][214] = 8377223;
        z[3][215] = 3580;
        z[3][216] = 25573;
        z[3][217] = 8339632;
        z[3][218] = 8269541;
        z[3][219] = 106860;
        z[3][220] = 8297180;
        z[3][221] = 8341892;
        z[3][222] = 8314796;
        z[3][223] = 116825;
        z[3][224] = 8280837;
        z[3][225] = 8312929;
        z[3][226] = 10784;
        z[3][227] = 8304968;
        z[3][228] = 8292898;
        z[3][229] = 8326653;
        z[3][230] = 8312330;
        z[3][231] = 8304056;
        z[3][232] = 8358164;
        z[3][233] = 40006;
        z[3][234] = 655;
        z[3][235] = 50050;
        z[3][236] = 8322301;
        z[3][237] = 75650;
        z[3][238] = 68755;
        z[3][239] = 8269162;
        z[3][240] = 8307892;
        z[3][241] = 4131;
        z[3][242] = 8345692;
        z[3][243] = 19674;
        z[3][244] = 8292285;
        z[3][245] = 95925;
        z[3][246] = 31254;
        z[3][247] = 8347403;
        z[3][248] = 91058;
        z[3][249] = 91628;
        z[3][250] = 8267752;
        z[3][251] = 8363784;
        z[3][252] = 8379479;
        z[3][253] = 8257325;
        z[3][254] = 8303634;
        z[3][255] = 8273900;

        uint256[][] memory z2 = new uint256[][](4);

        uint256 gasStart = gasleft();
        z2 = unpackZ(zBytes);
        uint256 gasUsed = gasStart - gasleft();
        console.log("Gas used:", gasUsed);

        for (uint256 i = 0; i < 4; i++) {
            for (uint256 j = 0; j < 256; j++) {
                assertEq(z2[i][j], z[i][j]);
            }
        }
    }
}
