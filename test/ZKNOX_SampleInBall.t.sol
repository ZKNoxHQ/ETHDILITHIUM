// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;
//  Code obtained from `generate_sample_in_ball_test_vectors.py` python file

import {Test} from "forge-std/Test.sol";
import "../src/ZKNOX_dilithium_utils.sol";
import "../src/ZKNOX_SampleInBall.sol";

contract SampleInBallTest is Test {
    function testSampleInBallNIST() public pure {
        bytes memory cTilde = hex"cc501e9f471a004d2d3f60894d12aad3114e8abf62e413a800b7e7987ec5100b"; // forgefmt: disable-next-line
uint256[256] memory expectedC = [uint256(0),8380416,0,1,0,0,0,0,0,0,0,0,0,1,8380416,0,0,8380416,0,0,0,0,0,0,8380416,0,0,0,8380416,0,1,0,0,0,8380416,8380416,0,0,0,0,8380416,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,8380416,8380416,0,0,0,0,1,1,0,0,0,8380416,0,0,0,0,0,1,0,0,0,1,0,0,0,8380416,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,8380416,0,0,0,0,0,0,1,8380416,0,0,0,0,0,0,0,0,0,0,8380416,0,0,0,0,0,0,0,0,0,0,1,0,0,8380416,0,0,0,0,0,8380416,8380416,0,0,0,0,0,0,0,0,0,0,8380416,8380416,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8380416,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,8380416,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0];

        uint256[] memory c = sampleInBallNist(cTilde, TAU, q);
        for (uint256 i = 0; i < 256; i++) {
            assertEq(c[i], expectedC[i]);
        }
    }

    function testSampleInBallKeccakPrng() public pure {
        bytes memory cTilde = hex"cc501e9f471a004d2d3f60894d12aad3114e8abf62e413a800b7e7987ec5100b"; // forgefmt: disable-next-line
uint256[256] memory expectedC = [uint256(0),0,0,0,0,0,1,0,0,8380416,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,8380416,0,0,0,0,0,0,8380416,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8380416,0,8380416,0,8380416,8380416,0,0,0,0,8380416,8380416,8380416,0,0,0,0,0,0,8380416,0,0,0,0,1,0,8380416,8380416,0,0,0,0,0,0,0,8380416,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8380416,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,8380416,0,0,0,8380416,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,8380416,8380416,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8380416,0,0,8380416,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0];

        uint256[] memory c = sampleInBallKeccakPrng(cTilde, TAU, q);
        for (uint256 i = 0; i < 256; i++) {
            assertEq(c[i], expectedC[i]);
        }
    }
}
